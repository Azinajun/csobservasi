<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluasi Function Rear D29D</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3498db;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --border-color: #bdc3c7;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px var(--shadow-color);
            padding: 30px;
            display: flex;
            flex-direction: column;
            min-height: 90vh;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 250px;
        }
        
        .user-info div {
            display: flex;
            align-items: center;
        }
        
        .user-info label {
            width: 70px;
            font-weight: 500;
            color: var(--dark-color);
        }
        
        .user-info input {
            flex-grow: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .user-info input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .title {
            text-align: center;
            flex-grow: 1;
        }
        
        .title h1 {
            margin: 0;
            color: var(--dark-color);
            font-size: 28px;
            font-weight: 700;
        }
        
        .title p {
            margin: 5px 0 0;
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: auto;
            align-self: flex-end;
        }
        
        .save-btn:hover {
            background-color: #2980b9;
        }
        
        .save-btn i {
            font-size: 18px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            table-layout: fixed;
        }
        
        th {
            background-color: var(--dark-color);
            color: white;
            font-weight: 500;
            padding: 12px 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }
        
        tr:nth-child(even) {
            background-color: var(--light-color);
        }
        
        tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .method-cell {
            text-align: center;
            width: 100px;
        }
        
        .method-btn {
            width: 36px;
            height: 36px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border: 1px solid var(--border-color);
            background-color: white;
            border-radius: 50%;
            margin: 0 5px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .method-btn:hover {
            transform: scale(1.1);
        }
        
        .method-btn.o {
            color: var(--success-color);
            border-color: var(--success-color);
        }
        
        .method-btn.x {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        
        .method-btn.selected.o {
            background-color: var(--success-color);
            color: white;
        }
        
        .method-btn.selected.x {
            background-color: var(--danger-color);
            color: white;
        }
        
        textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            resize: vertical;
            min-height: 40px;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .no-data {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-style: italic;
        }
        
@media (max-width: 768px) {
    .header {
        flex-direction: column-reverse !important;
        gap: 15px;
    }

    .logo-daihatsu {
        position: static !important;
        display: block;
        margin: 0 auto 10px;
        height: 50px !important;
    }

    .title h1 {
        font-size: 18px !important;
    }

    .title p {
        font-size: 12px !important;
    }

    .save-btn {
        font-size: 14px !important;
        padding: 10px 16px !important;
    }

    th, td, textarea, input {
        font-size: 14px !important;
    }

    table {
        display: block;
        overflow-x: auto;
    }
}
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>
<body>
     <div class="container">
        <div class="header">
            <div class="user-info">
                <div>
                    <label for="name">Name:</label>
                    <input type="text" id="name" placeholder="Your name">
                </div>
                <div>
                    <label for="npk">NPK:</label>
                    <input type="text" id="npk" placeholder="Your NPK">
                </div>
            </div>
            
            <div class="title">
                <h1>Evaluasi Function Rear D29D</h1>
                <p>Vehicle Audit</p>
            </div>
        </div>

        <table id="checksheet">
            <thead>
                <tr>
                    <th style="width: 50px;">No</th>
                    <th style="width: 200px;">Area</th>
                    <th>Item Check</th>
                    <th style="width: 120px;">Metode</th>
                    <th style="width: 250px;">Note</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table content will be generated by JavaScript -->
            </tbody>
        </table>

        <button id="saveBtn" class="save-btn">
            <i class="fas fa-save"></i>
            Simpan
        </button>
    </div>
       
    <script>
        // Data from the Excel file
        const checkData = [
            { no: 1, area: "Check Rr door outer Rh", items: [
                "1.Check door belt molding.",
                "2.Check glass run.",
                "3.Check glass Rr door outer Rh",
                "4.Check outer handle Rr door."
            ]},
            { no: 2, area: "Check Rr door inner Rh (back side)", items: [
                "1.Buka Rr door.",
                "2.Check link catch assy upper.",
                "3.Check Braket hinge Rr door Rear.",
                "4.Check lock assy Rr door .",
                "5.Check cover rail sliding saat Rr door di buka.",
                "6.Check Rr door trim rear area."
            ]},
            { no: 3, area: "Check Rr door inner Rh (Front side)", items: [
                "1.Check braket Rr door upper.",
                "2.Check male & male junction.",
                "3.Check catch assy Fr",
                "4.Check braket Rr door lower.",
                "5.Check Rr door trim bagian depan.",
                "6.Check regulator window"
            ]},
            { no: 4, area: "Check opening Rr door Rh (Sisi belakang)", items: [
                "1.Check switch courtasy lamp.",
                "2.Check lock striker & rail sliding sisi depan.",
                "3.Check braket stopper upper.",
                "4.Check opening trim sisi belakang."
            ]},
            { no: 5, area: "Check opening Rr door Rh (Sisi depan)", items: [
                "1.Check Weather strip Rr door upper.",
                "2.Check opening trim Rr door upper.",
                "3.Check female & female junction.",
                "4.Check lock catch assy opening.",
                "5.Check opening trim sisi depan."
            ]},
            { no: 6, area: "Check opening, foot step Rr door Rh.", items: [
                "1.Check opening trim lower.",
                "2.Check braket stopper Rr door lower.",
                "3.Check carpet foot step & komponen under carpet",
                "4.Check floor carpet under Rr seat Rh dan komponen under floor.",
                "5.Check leg Rr seat Rh."
            ]},
            { no: 7, area: "Check Seat cushion & seat belt.", items: [
                "1.Check seat cushion",
                "2.Check seat belt Rr seat center.",
                "3.Check cover reclining.",
                "4.check seat belt Rr seat Rh"
            ]},
            { no: 8, area: "Check Rr door inner dari kabin.", items: [
                "1.Masuk dan tutup pintu.",
                "2.Check Run glass inner Rh",
                "3.Check Belt molding .",
                "4.Check Rr door glass inner Rh.",
                "5.Check lock button.",
                "6.Check inner handle .",
                "7.Check Rr door trim & label.",
                "8.Check regulator window."
            ]},
            { no: 9, area: "Check inner cabin Rr door Rh", items: [
                "1.Check center pillar garnish bawah",
                "2.Check Regulator & sparator bar.",
                "3.Check roof headlining",
                "4.check opening trim dari dalam.",
                "5.Keluar dari unit."
            ]},
            { no: 10, area: "Check fitting Rr door.", items: [
                "1.Check operation lock.",
                "2.Check Rr door fitting."
            ]},
            { no: 11, area: "Check Quarter Rh", items: [
                "1.Check quarter glass",
                "2.Check rail sliding",
                "3.Check cover rail sliding.",
                "4.Check mudguard Rr Rh.",
                "5.Check tire & wheel rim",
                "6.Check sekitar wheel house."
            ]},
            { no: 12, area: "Check Rr bumper Rr combi lamp", items: [
                "1.Check Rr combi & spacer Rh.",
                "2.Check Rr bumper dari Rh ke Lh.",
                "3.Check housing hook Rr.",
                "4.Check Rr combi & spacer Lh"
            ]},
            { no: 13, area: "Check Rr door outer Lh", items: [
                "1.Check door belt molding.",
                "2.Check glass run.",
                "3.Check glass Rr door outer Lh",
                "4.Check outer handle Rr door."
            ]},
            { no: 14, area: "Check Rr door inner Lh", items: [
                "1.Buka Rr door.",
                "2.Check link catch assy upper.",
                "3.Check Braket hinge Rr door Rear.",
                "4.Check lock assy Rr door .",
                "5.Check cover rail sliding saat Rr door di buka.",
                "6.Check Rr door trim rear area."
            ]},
            { no: 15, area: "Check Rr door inner Lh (Front side)", items: [
                "1.Check braket Rr door upper.",
                "2.Check male & male junction.",
                "3.Check catch assy Fr",
                "4.Check braket Rr door lower.",
                "5.Check Rr door trim bagian depan.",
                "6.Check regulator window"
            ]},
            { no: 16, area: "Check opening Rr door Lh (isi belakang)", items: [
                "1.Check switch courtasy lamp.",
                "2.Check lock striker & rail sliding sisi depan.",
                "3.Check braket stopper upper.",
                "4.Check opening trim sisi belakang."
            ]},
            { no: 17, area: "Check opening Rr door Lh. (isi depan)", items: [
                "1.Check Weather strip Rr door upper.",
                "2.Check opening trim Rr door upper.",
                "3.Check female & female junction.",
                "4.Check lock catch assy opening.",
                "5.Check opening trim sisi depan."
            ]},
            { no: 18, area: "Check opening,foot step Rr door Lh.", items: [
                "1.Check opening trim lower.",
                "2.Check braket stopper Rr door lower.",
                "3.Check carpet foot step & komponen under carpet",
                "4.Check floor carpet under Rr seat Lh dan komponen under floor.",
                "5.Check leg Rr seat Lh."
            ]},
            { no: 19, area: "Check Seat cushion & seat belt.", items: [
                "1.Check seat cushion",
                "2.Check cover reclining.",
                "3.check seat belt Rr seat Lh"
            ]},
            { no: 20, area: "Check Rr door inner dari kabin. (door Lh)", items: [
                "1.Masuk dan tutup pintu.",
                "2.Check Run glass inner Lh",
                "3.Check Belt molding .",
                "4.Check Rr door glass inner Lh.",
                "5.Check lock button.",
                "6.Check inner handle .",
                "7.Check Rr door trim.",
                "8.Check regulator window."
            ]},
            { no: 21, area: "Check inner cabin (Rr door Lh)", items: [
                "1.Check center pillar garnish bawah",
                "2.Check Regulator & sparator bar.",
                "3.Check roof headlining",
                "4.check opening trim dari dalam.",
                "5.Keluar dari unit."
            ]},
            { no: 22, area: "Check fitting (Rr door Lh)", items: [
                "1.Check operation lock.",
                "2.Check Rr door fitting."
            ]},
            { no: 23, area: "Check Quarter Lh", items: [
                "1.Check quarter glass",
                "2.Check rail sliding & Cover",
                "3.Check mudguard Rr Lh.",
                "4.Check tire & wheel rim",
                "5.Check sekitar wheel house."
            ]},
            { no: 24, area: "Check back door inner (Check semua sisi Rh & Lh)", items: [
                "1.Buka pintu back door",
                "2.Check lock assy dan inner handle back door.",
                "3.Check back door trim & cushion rubber",
                "4.Check B/D glass,deforger dan molding",
                "5.Check stay back door.",
                "6.Check gromet B/D inner"
            ]},
            { no: 25, area: "Check Back door opening (Check semua sisi Rh & Lh)", items: [
                "1.Check gromet B/D upper & hinge.",
                "2.Check opg.trim back door.",
                "3.Check combi lamp area opg Rh&Lh.",
                "4.Check part area opening bawah",
                "5.Check scuff opening back door."
            ]},
            { no: 26, area: "Check cabin rear (Check semua sisi Rh & Lh)", items: [
                "1.Check quarter trim cover hole Rh",
                "â€»Jika unit 4 WD check cover Rear heater.",
                "2.Check quarter glass & molding Rh.",
                "3.Check cover safety belt Rh.",
                "4.Check roof headlining rear & inner room lamp.",
                "5.Check quarter glass & molding Lh",
                "6.Check quarter trim & cover hole Lh",
                "7.Check cover safety belt Lh."
            ]},
            { no: 27, area: "Check back Rr seat dan floor.", items: [
                "1.Check area belakang Rr seat.",
                "2.Check area bawah seat.",
                "3.Check Floor carpet & componen under floor.",
                "4.Check lock Rr seat."
            ]},
            { no: 28, area: "Check back door outer dan fitting.", items: [
                "1.Tutup pintu back door.",
                "2.Check stop lamp,back door mirror dan nozzle.",
                "3.Check B/D glass & Rear wipper",
                "4.Check emblem & cover handle.",
                "5.Check area garnish & licanse lamp",
                "6.Check label area back door.",
                "7.Check back door fitting"
            ]}
        ];

        // Generate the table
        const tableBody = document.querySelector('#checksheet tbody');
        
        checkData.forEach(section => {
            section.items.forEach((item, index) => {
                const row = document.createElement('tr');
                
                if (index === 0) {
                    const noCell = document.createElement('td');
                    noCell.rowSpan = section.items.length;
                    noCell.textContent = section.no;
                    row.appendChild(noCell);
                    
                    const areaCell = document.createElement('td');
                    areaCell.rowSpan = section.items.length;
                    areaCell.innerHTML = section.area.replace(/<br>/g, '<br>');
                    row.appendChild(areaCell);
                }
                
                const itemCell = document.createElement('td');
                itemCell.textContent = item;
                row.appendChild(itemCell);
                
                const methodCell = document.createElement('td');
                methodCell.className = 'method-cell';
                
                const oBtn = document.createElement('button');
                oBtn.className = 'method-btn o';
                oBtn.textContent = 'O';
                oBtn.addEventListener('click', () => {
                    oBtn.classList.toggle('selected');
                    xBtn.classList.remove('selected');
                });

                const xBtn = document.createElement('button');
                xBtn.className = 'method-btn x';
                xBtn.textContent = 'X';
                xBtn.addEventListener('click', () => {
                    xBtn.classList.toggle('selected');
                    oBtn.classList.remove('selected');
                });

                methodCell.appendChild(oBtn);
                methodCell.appendChild(xBtn);
                row.appendChild(methodCell);

                const noteCell = document.createElement('td');
                const noteInput = document.createElement('textarea');
                noteCell.appendChild(noteInput);
                row.appendChild(noteCell);

                tableBody.appendChild(row);
            });
        });

        // Export to Excel function
        document.getElementById('saveBtn').addEventListener('click', () => {
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['No', 'Area', 'Item Check', 'Metode', 'Note']
            ];

            let currentNo = '', currentArea = '';
            const rows = document.querySelectorAll('#checksheet tbody tr');

            rows.forEach(row => {
                const cells = row.children;
                if (cells.length === 5) {
                    currentNo = cells[0].innerText;
                    currentArea = cells[1].innerText;
                    var item = cells[2].innerText;
                    var method = cells[3].querySelector('.method-btn.selected')?.textContent || '';
                    var note = cells[4].querySelector('textarea').value;
                } else if (cells.length === 3) {
                    var item = cells[0].innerText;
                    var method = cells[1].querySelector('.method-btn.selected')?.textContent || '';
                    var note = cells[2].querySelector('textarea').value;
                }

                wsData.push([currentNo, currentArea, item, method, note]);
            });

            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Checksheet');

            const name = document.getElementById('name').value || 'unknown';
            const npk = document.getElementById('npk').value || '0000';
            const fileName = `Checksheet_${name}_${npk}.xlsx`;

            XLSX.writeFile(wb, fileName);
        });
    </script>
</body>
</html>

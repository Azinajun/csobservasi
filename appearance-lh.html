<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluasi Appearance Lh D29D</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3498db;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --border-color: #bdc3c7;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px var(--shadow-color);
            padding: 30px;
            display: flex;
            flex-direction: column;
            min-height: 90vh;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 250px;
        }
        
        .user-info div {
            display: flex;
            align-items: center;
        }
        
        .user-info label {
            width: 70px;
            font-weight: 500;
            color: var(--dark-color);
        }
        
        .user-info input {
            flex-grow: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .user-info input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .title {
            text-align: center;
            flex-grow: 1;
        }
        
        .title h1 {
            margin: 0;
            color: var(--dark-color);
            font-size: 28px;
            font-weight: 700;
        }
        
        .title p {
            margin: 5px 0 0;
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: auto;
            align-self: flex-end;
        }
        
        .save-btn:hover {
            background-color: #2980b9;
        }
        
        .save-btn i {
            font-size: 18px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            table-layout: fixed;
        }
        
        th {
            background-color: var(--dark-color);
            color: white;
            font-weight: 500;
            padding: 12px 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }
        
        tr:nth-child(even) {
            background-color: var(--light-color);
        }
        
        tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .method-cell {
            text-align: center;
            width: 100px;
        }
        
        .method-btn {
            width: 36px;
            height: 36px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border: 1px solid var(--border-color);
            background-color: white;
            border-radius: 50%;
            margin: 0 5px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .method-btn:hover {
            transform: scale(1.1);
        }
        
        .method-btn.o {
            color: var(--success-color);
            border-color: var(--success-color);
        }
        
        .method-btn.x {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        
        .method-btn.selected.o {
            background-color: var(--success-color);
            color: white;
        }
        
        .method-btn.selected.x {
            background-color: var(--danger-color);
            color: white;
        }
        
        textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            resize: vertical;
            min-height: 40px;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .no-data {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-style: italic;
        }
        
@media (max-width: 768px) {
    .header {
        flex-direction: column-reverse !important;
        gap: 15px;
    }

    .title h1 {
        font-size: 18px !important;
    }

    .title p {
        font-size: 12px !important;
    }

    .save-btn {
        font-size: 14px !important;
        padding: 10px 16px !important;
    }

    th, td, textarea, input {
        font-size: 14px !important;
    }

    table {
        display: block;
        overflow-x: auto;
    }
}
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
</head>
<body>
     <div class="container">
        <div class="header">
            <div class="user-info">
                <div>
                    <label for="name">Name:</label>
                    <input type="text" id="name" placeholder="Your name">
                </div>
                <div>
                    <label for="npk">NPK:</label>
                    <input type="text" id="npk" placeholder="Your NPK">
                </div>
            </div>
            
            <div class="title">
                <h1>Evaluasi Appearance Lh D29D</h1>
                <p>Vehicle Audit</p>
            </div>
        </div>

        <table id="checksheet">
            <thead>
                <tr>
                    <th style="width: 50px;">No</th>
                    <th style="width: 200px;">Area</th>
                    <th>Item Check</th>
                    <th style="width: 120px;">Metode</th>
                    <th style="width: 250px;">Note</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table content will be generated by JavaScript -->
            </tbody>
        </table>

        <button id="saveBtn" class="save-btn">
            <i class="fas fa-save"></i>
            Simpan
        </button>
    </div>
       
    <script>
        // Data from the Excel file
        const checkData = [
            { no: 1, area: "Hood Inner,Dash panel & Hood panel", items: [
                "1.Cek sealer hood panel dari bagian depan sampai belakang",
                "2.Cek Appearance inner hood panel dari bagian belakang hingga depan",
                "3.Cek pada bagian hinge hood panel",
                "4.Cek dash panel LH",
                "5.Cek Panel suport radiator Lh"
            ]},
            { no: 2, area: "Hood outer", items: [
                "1.Cek apperance hood panel dari bagian depan hingga belakang",
                "2.Cek Heming hood panel dari belakang hingga depan",
                "3.Cek angle looking /looking aslant dari arah depan hingga belakang dari sisi Rh & Lh"
            ]},
            { no: 3, area: "Cek Bumper bagian depan", items: [
                "1.Cek apperance secara dirrect looking  bumper bagian depan dari atas sampai bawah",
                "2.Cek bagian Heming Fr bumper Rh",
                "3.Cek angle looking pada bagian FR bumper dari sisi Rh dan Lh"
            ]},
            { no: 4, area: "Fender", items: [
                "1.Cek appearance fender panel dirrect looking,dari atas hingga bawah",
                "2.Cek Heming sekeliling fender",
                "3.Cek looking angle looking",
                "4.Check wheel arc fender",
                "5.Check wheel house"
            ]},
            { no: 5, area: "Fr pillar Lh", items: [
                "1.Cek direct looking pada Fr pillar Lh",
                "2.Cek bagian heming Fr pillar Lh",
                "3.Cek angle looking dari bagian bawah ke atas dan dari atas hingga bawah"
            ]},
            { no: 6, area: "Fr door outer", items: [
                "1.Check door frame dari depan hingga belakang secara direct looking",
                "2.Cek Heming frame Fr door",
                "3.Cek Frame angle looking",
                "4.Cek appearance direct looking Fr door Lh dimulai dari depan hingga belakang dari atas hingga bawah",
                "5.Cek Heming panel Fr door",
                "6.Cek angel looking Fr door",
                "7.Cek opening cover fuel lid,cek inner cover fuel lid",
                "8.Cek Rocker panel"
            ]},
            { no: 7, area: "Fr door inner", items: [
                "1.Buka pintu",
                "2.Check sealer inner Fr door Lh",
                "3.Cek inner door frame",
                "4.Cek Panel inner Fr door Lh"
            ]},
            { no: 8, area: "Fr door opening", items: [
                "1.Cek Opening Fr door Panel Lh dimulai dari bagian depan,hingga belakang berlawanan arah jarum jam"
            ]},
            { no: 9, area: "Roof panel Fr door Lh", items: [
                "1.Cek chanel drip roof Fr door Lh, cek aplikasi sealer",
                "2.Cek Roof panel di mulai dari roof bagian depan",
                "3.Cek heming roof panel bagian depan",
                "4.Cek angel looking roof panel Fr door Lh"
            ]},
            { no: 10, area: "Frame Rear door panel", items: [
                "1.Cek  panel Rr door Outer  Lh",
                "2.Cek Heming Frame Rr door Lh Outer",
                "3.Cek Angel looking Frame Rr door Lh"
            ]},
            { no: 11, area: "Rr door Panel Lh", items: [
                "1.Cek Rr door panel Lh",
                "2.Cek Heming  Rr door Lh Outer",
                "3.Cek Angel looking  Rr door Rh"
            ]},
            { no: 12, area: "Rocker panel Rr door Lh", items: [
                "1.Cek Rocker panel Rr door Lh",
                "2.Cek Heming  Rocker panel door Lh Outer",
                "3.Cek Angel looking  Rocker panel Rr door Lh"
            ]},
            { no: 13, area: "Inner Rr door panel Lh", items: [
                "1.Cek Inner Rr door panel bagian belakang,ceka sealer,panel",
                "2.Cek Inner Rr door bagian atas",
                "3.Cek Inner Rr door bagian depan",
                "4.Cek Inner Rr door bagian lower / bawah"
            ]},
            { no: 14, area: "Cek Opening Rr door Lh", items: [
                "1.Cek opening panel Rr door Lh bagian belakang",
                "2.Cek opening panel Rr door Lh bagian atas",
                "3.Cek opening panel Rr door Lh bagian depan dan foot step"
            ]},
            { no: 15, area: "Check B Pillar Inner dan inner Rr door Lh", items: [
                "1.Cek  Panel B Pillar inner Rr door Lh",
                "2.Cek Panel Inner RR door Lh dimulai dari bagian depan sampai belakang"
            ]},
            { no: 16, area: "Chanel drip,Roof Panel Rr door Lh", items: [
                "1.Cek Chanel drip Rr door Lh & Sealer pada chanel drip",
                "2.Cek Roof Panel Rr door Lh direct sight",
                "3.Cek Angel looking roof panel Rr door Lh dari sisi depan dan belakang"
            ]}
        ];

        // Generate the table
        const tableBody = document.querySelector('#checksheet tbody');
        
        checkData.forEach(section => {
            section.items.forEach((item, index) => {
                const row = document.createElement('tr');
                
                if (index === 0) {
                    const noCell = document.createElement('td');
                    noCell.rowSpan = section.items.length;
                    noCell.textContent = section.no;
                    row.appendChild(noCell);
                    
                    const areaCell = document.createElement('td');
                    areaCell.rowSpan = section.items.length;
                    areaCell.innerHTML = section.area.replace(/<br>/g, '<br>');
                    row.appendChild(areaCell);
                }
                
                const itemCell = document.createElement('td');
                itemCell.textContent = item;
                row.appendChild(itemCell);
                
                const methodCell = document.createElement('td');
                methodCell.className = 'method-cell';
                
                const oBtn = document.createElement('button');
                oBtn.className = 'method-btn o';
                oBtn.textContent = 'O';
                oBtn.addEventListener('click', () => {
                    oBtn.classList.toggle('selected');
                    xBtn.classList.remove('selected');
                });

                const xBtn = document.createElement('button');
                xBtn.className = 'method-btn x';
                xBtn.textContent = 'X';
                xBtn.addEventListener('click', () => {
                    xBtn.classList.toggle('selected');
                    oBtn.classList.remove('selected');
                });

                methodCell.appendChild(oBtn);
                methodCell.appendChild(xBtn);
                row.appendChild(methodCell);

                const noteCell = document.createElement('td');
                const noteInput = document.createElement('textarea');
                noteCell.appendChild(noteInput);
                row.appendChild(noteCell);

                tableBody.appendChild(row);
            });
        });

        // Export to Excel function
        document.getElementById('saveBtn').addEventListener('click', () => {
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['No', 'Area', 'Item Check', 'Metode', 'Note']
            ];

            let currentNo = '', currentArea = '';
            const rows = document.querySelectorAll('#checksheet tbody tr');

            rows.forEach(row => {
                const cells = row.children;
                if (cells.length === 5) {
                    currentNo = cells[0].innerText;
                    currentArea = cells[1].innerText;
                    var item = cells[2].innerText;
                    var method = cells[3].querySelector('.method-btn.selected')?.textContent || '';
                    var note = cells[4].querySelector('textarea').value;
                } else if (cells.length === 3) {
                    var item = cells[0].innerText;
                    var method = cells[1].querySelector('.method-btn.selected')?.textContent || '';
                    var note = cells[2].querySelector('textarea').value;
                }

                wsData.push([currentNo, currentArea, item, method, note]);
            });

            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Checksheet');

            const name = document.getElementById('name').value || 'unknown';
            const npk = document.getElementById('npk').value || '0000';
            const fileName = `Checksheet_${name}_${npk}.xlsx`;

            XLSX.writeFile(wb, fileName);
        });
    </script>
</body>
</html>
